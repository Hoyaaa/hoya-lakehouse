# Webdata Crawler Package – G2B 입찰공고 자동 수집 및 필터링

나라장터(G2B, https://www.g2b.go.kr/)의 입찰공고를 **자동으로 수집하고, 엑셀 파일을 기준으로 필터링하는** 파이썬 스크립트 모음입니다.

이 프로젝트는 다음 두 개의 스크립트로 구성됩니다.

- `web data extraction.py`  
  : 엑셀에 적어둔 **입찰공고번호 목록**을 기준으로, G2B 사이트에서 각 공고의 **상세 정보를 자동으로 크롤링**하여 CSV로 저장
- `Data merging and deduplication.py`  
  : 로컬 폴더에 저장된 `입찰공고목록*.xls*` 파일 중 **가장 최신 엑셀 파일을 자동으로 찾은 뒤**, 공고명을 기준으로 **불필요한 공고를 필터링**하고 결과를 엑셀로 저장

> 실제 코드 상의 동작을 있는 그대로 문서화한 README입니다.  
> (경로·키워드 등은 코드 내 상수 값을 사용합니다)

---

## 1. 프로젝트 개요

### 1.1 목표

- 엑셀에 정리된 **입찰공고번호** 목록을 이용해, G2B 웹 UI를 자동 조작하여 공고 상세 정보를 수집
- 나라장터에서 내려받은 `입찰공고목록` 엑셀 파일에서, **공고명에 특정 키워드가 포함된 공고를 자동으로 제외**하여 관심 있는 공고만 남김
- 반복적인 수작업(사이트 검색/복사/필터링)을 자동화하여 업무 효율 향상

### 1.2 주요 기능

- Selenium + ChromeDriver를 이용한 **브라우저 자동 조작**
- G2B 상단 메뉴 → `입찰 > 입찰공고목록` 화면 자동 진입
- 공고번호 단위 검색 → 공고명 클릭 → 상세 페이지 진입
- 상세 페이지에서 다음 6개 항목 추출

  - 입찰공고번호
  - 공고기관
  - 공고명
  - 사업금액
  - 시작일시
  - 종료일시

- `입찰공고목록*.xls*` 엑셀 파일 중 **수정시간이 가장 최근인 파일 자동 선택**
- ‘공고명’ 또는 ‘제목’ 컬럼을 자동으로 찾아 헤더 행 인식
- 공고명에 특정 키워드(공사, 납품, 임대 등)가 포함된 행을 **제외**하고, 전체/유지/제외 데이터를 각각 별도 엑셀로 출력

---

## 2. 파일 구조

```
Webdata_Crawler_package/
├─ web data extraction.py          # G2B 입찰공고 상세 정보 크롤러
├─ Data merging and deduplication.py  # 최신 입찰공고목록 엑셀 자동 탐색 + 공고명 키워드 필터링
└─ (데이터 파일은 로컬 경로를 사용하며, 코드 상수에서 경로를 지정)
현재 코드에서는 Windows 경로를 직접 상수로 지정하여 사용합니다.

web data extraction.py

EXCEL_PATH = r"D:\재택근무\11월\11월_4주차\data\입찰공고번호.xlsx"

OUT_CSV = r"D:\재택근무\11월\11월_4주차\data\입찰공고_추출결과.csv" web data extraction

Data merging and deduplication.py

BASE_DIR = r"D:\재택근무\11월\11월_4주차\data" Data merging and deduplication

GitHub에 올릴 때는 상대 경로로 수정하는 것을 추천합니다.
```

## 3. 필요 환경 및 라이브러리
```
3.1 공통
Python 3.x

Google Chrome 브라우저

3.2 파이썬 패키지
두 스크립트에서 사용하는 주요 패키지는 다음과 같습니다.

pandas

openpyxl

selenium

webdriver-manager

예시 설치 명령:
pip install pandas openpyxl selenium webdriver-manager
```

## 4. web data extraction.py
```
엑셀에 적어둔 입찰공고번호 목록을 기준으로, G2B 사이트에서 상세 정보를 크롤링하여 CSV로 저장하는 스크립트입니다. web data extraction

4.1 입력 / 출력
입력

EXCEL_PATH에 지정된 엑셀 파일

기본값: D:\재택근무\11월\11월_4주차\data\입찰공고번호.xlsx

엑셀 파일에서 다음 중 하나 이름을 가진 컬럼을 찾습니다.

입찰공고번호 또는 공고번호

둘 중 없다면, 첫 번째 컬럼을 공고번호 컬럼으로 사용

출력

OUT_CSV에 지정된 CSV 파일 (append 모드)

기본값: D:\재택근무\11월\11월_4주차\data\입찰공고_추출결과.csv

컬럼:

입찰공고번호, 공고기관, 공고명, 사업금액, 시작일시, 종료일시

10건 처리할 때마다 중간 저장을 수행하여, 중간에 오류가 나더라도 그 시점까지의 결과는 CSV에 누적됩니다.

4.2 동작 흐름
ChromeDriver 초기화

webdriver_manager.chrome.ChromeDriverManager().install()을 사용해 크롬 드라이버를 자동 다운로드 및 설정

브라우저 창을 최대화하여 시작

G2B 접속 및 메뉴 이동

https://www.g2b.go.kr/ 접속

상단 메뉴에서 입찰 탭에 마우스 오버

하위 메뉴 입찰공고목록 클릭

새 탭이 열릴 경우 새 탭으로 전환

입찰공고번호 목록 로드

EXCEL_PATH의 엑셀 파일을 pandas.read_excel()로 읽기

컬럼명 탐색 후, 공고번호 목록을 문자열 리스트로 생성

공고번호별 반복 처리
각 공고번호에 대해 다음을 수행합니다.

검색창에 공고번호 입력 후 검색 버튼 클릭

결과 테이블에서 해당 공고번호 행의 공고명 링크 클릭

상세 페이지 진입 후, 다음 항목 추출

입찰공고번호

공고기관

공고명

사업금액 (사업금액/배정예산/추정가격 등 우선순위 로직 포함)

시작일시

종료일시 (그리드 헤더의 ‘종료일시’ 텍스트를 기준으로 동적으로 컬럼 탐색)

안내 메시지 팝업이 뜰 경우, ‘확인’ 버튼 또는 닫기(X)를 자동으로 클릭하여 처리

목록 화면으로 복귀 (새 탭이면 탭 닫기, 동일 탭이면 back() 이용)

10건마다 CSV에 중간 저장

전체 처리 완료 후

반복에서 남은 데이터가 있다면 마지막으로 CSV에 저장

브라우저는 자동으로 닫지 않고 유지 (코드 상 마지막에 driver.quit() 호출 없음)

4.3 실행 방법
bash
코드 복사
python "web data extraction.py"
실행 전에 아래 값을 환경에 맞게 수정하는 것을 권장합니다.

EXCEL_PATH

OUT_CSV
```

## 5. Data merging and deduplication.py
```
로컬 폴더에서 입찰공고목록*.xls* 파일 중 가장 최근 파일을 찾아, 공고명을 기준으로 특정 키워드를 포함하는 공고를 제외/분리하여 세 개의 엑셀 파일로 저장하는 스크립트입니다. (현재 코드 상, 실제 병합/중복제거 로직은 포함되어 있지 않고 필터링 역할을 수행합니다.) Data merging and deduplication

5.1 입력 / 출력
입력

BASE_DIR에 지정된 폴더 내의 엑셀 파일

파일명 패턴: 입찰공고목록*.xls*

예: 입찰공고목록_20241125.xls, 입찰공고목록_20241125.xlsx 등

해당 폴더에서 위 패턴과 일치하는 파일 중, 수정시간(최종 수정일)이 가장 최근인 파일 1개를 사용

출력

아래 3개의 엑셀 파일을 BASE_DIR에 저장

입찰공고_전체데이터.xlsx : 필터링 전 전체 원본 데이터

입찰공고_필터링결과.xlsx : 공고명 기준 키워드에 걸리지 않은 데이터(유지 대상)

입찰공고_제외된데이터.xlsx : 공고명에 특정 키워드가 포함되어 제외된 데이터

5.2 공고명 컬럼 자동 인식
엑셀 파일의 구조가 고정돼 있지 않은 상황을 고려하여, 스크립트는 다음과 같이 헤더 행과 공고명 컬럼을 자동으로 찾습니다.

엑셀 파일의 모든 시트를 순회

각 시트에서 모든 행을 읽어, 한 행에

‘공고명’ 텍스트가 포함된 셀 또는

셀이 정확히 ‘제목’인 경우
가 존재하면, 해당 행을 헤더 행으로 간주

그 행의 값을 컬럼명으로 사용하고, 그 아래 행부터를 데이터로 인식

헤더의 공백 제거/정규화 결과가

공고명을 포함하거나

제목과 일치하는 컬럼을 공고명 컬럼으로 사용

5.3 필터링 키워드
코드 상단의 exclude_keywords_text에 여러 단어가 공백으로 나열되어 있으며, 이 단어들을 모두 OR 조건으로 묶어 정규식 패턴을 생성합니다. 예시:

제품, 납품, 시공, 공사, 임차, 구매, 포장, 조달, 운송, 폐기물, 리모델링, 구조물, 철거, 토목, 공장, 택배, 물류, 임대, 버스, 지하철, 대관, 비품, 폐기, 청소, 방역, 재개발, 조명, 의료, 주차, 제설, 상가, 재활용, 쓰레기, 소각, 매각, 반도체, 터널, 은행, 보안, 분양, 회계, 주택, 방송, 재해복구, 소방시설, 콘크리트, 수해복구, 산불피해, 건설, 병영, 무기, 도로, 운전면허 등

해당 단어들 중 하나라도 공고명에 포함되면 "제외대상"으로 분류됩니다.

5.4 동작 흐름
입력 파일 자동 탐색

BASE_DIR 폴더를 기준으로 입찰공고목록*.xls* 파일 목록을 조회

일치하는 파일이 없으면 FileNotFoundError 발생

있으면 수정시간을 기준으로 가장 최근 파일 1개 선택 후, 경로 출력

헤더 및 공고명 컬럼 자동 탐지

read_with_header_detection_any_sheet() 함수에서 시트를 돌며 헤더 행과 컬럼명 구성

find_announcement_col()에서 공고명/제목 컬럼 찾기

찾지 못하면 KeyError 발생

필터링 수행

공고명 컬럼을 문자열로 변환

exclude_keywords_text로부터 정규식 패턴 생성

패턴이 포함되지 않은 행 → 유지(df_filtered)
패턴이 포함된 행 → 제외(df_removed)

엑셀 파일로 저장

원본 전체 데이터, 필터링 결과, 제외 데이터 각각을 to_excel()로 저장

파일명:

입찰공고_전체데이터.xlsx

입찰공고_필터링결과.xlsx

입찰공고_제외된데이터.xlsx

5.5 실행 방법
bash
코드 복사
python "Data merging and deduplication.py"
실행 전, 아래 값을 환경에 맞게 수정하는 것을 권장합니다.

BASE_DIR : 입찰공고목록*.xls* 파일이 저장된 폴더 경로
```

## 6. 커스터마이징 포인트
```

경로 변경

EXCEL_PATH, OUT_CSV, BASE_DIR를 상대 경로나 환경변수 기반으로 변경

필터링 키워드 변경

exclude_keywords_text에 포함된 단어들을 업무 목적에 맞게 추가/삭제

컬럼명/스키마 확장

크롤링 대상 컬럼을 추가하고 싶다면 parse_detail() 내 추출 로직 및 CSV 헤더 정의를 수정
```

